>EN
# Classification Algorithms and User Purchase Predictions

### Question 2

**Question 2** focuses on the application of classification algorithms using data from the Amazon reviews dataset, specifically targeting products in the â€œChargers & Power Adaptersâ€ and â€œCar Chargersâ€ categories.

**Step 1**: You start with preprocessing the data from the "meta_Cell_Phones_and_Accessories.json" file, retaining only products with non-empty descriptions and the relevant categories. You create a final dataset with product descriptions and categories.

**Step 2**: You experiment with three classifiers: Logistic Regression, SVM, and Multi-Layer Perceptron. You use 5-fold cross-validation to evaluate the models and the tf-idf representation of the descriptions for feature extraction. You report the average confusion matrix and the metrics of accuracy, precision, recall, and F1-measure.

**Step 3**: You use the same data from Step 1 but extract features using the Doc2Vec model that you train yourself. You perform k-fold cross-validation and measure the same metrics.

**Step 4**: You utilize the existing Glove word embeddings to train a classifier, representing the text as the average of the embeddings.

**Bonus**: Additionally, you can experiment with extra product characteristics to enhance classification quality.

<br>

### Question 3

**Question 3** focuses on using the Personalized Pagerank algorithm to predict whether a user will purchase a product.

**Data**: You are provided with two files: graph_train_data.txt, which contains pairs (reviewerID, asin) indicating products purchased by users, and graph_test_data.txt, which contains pairs for which you need to predict the purchase.

**Step 1**: You create a bipartite graph from the training data, where the nodes are users (reviewerID) and products (asin) with edges indicating purchases.

**Step 2**: For each pair (ğ‘Ÿ, ğ‘) in the test set, you run the Personalized Pagerank algorithm with node ğ‘Ÿ as the restart point. Sort the products based on the probabilities generated by the algorithm, excluding products already purchased by the user.

**Step 3**: Record the ranking position of the product ğ‘ and calculate two metrics to evaluate the algorithm: the Mean Reciprocal Rank (MRR) and the hit-ratio in the top K positions (HR@K) for K = 1,â€¦,20. Finally, create a plot of HR@K against K.

<br>
<br>

The following file is required:
<br>
The meta_Cell_Phones_and_Accessories.json file contains metadata related to products in the "Cell Phones & Accessories" category from Amazon. Specifically, this file includes information such as:
* reviewerID: A unique identifier for the user who left the review.
* asin: A unique identifier for the product.
* description: A description of the product, which may consist of a list of strings.
* category: Categories of products to which each item belongs.

---
>GR
# Î‘Î»Î³Î¿ÏÎ¯Î¸Î¼Î¿Î¹ ÎšÎ±Ï„Î·Î³Î¿ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î ÏÎ¿Î²Î»Î­ÏˆÎµÎ¹Ï‚ Î‘Î³Î¿ÏÏÎ½ Î§ÏÎ·ÏƒÏ„ÏÎ½

### Î•ÏÏÏ„Î·ÏƒÎ· 2

Î— **Î•ÏÏÏ„Î·ÏƒÎ· 2** Î±Ï†Î¿ÏÎ¬ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î±Î»Î³Î¿ÏÎ¯Î¸Î¼Ï‰Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿ Amazon reviews dataset, ÎµÏƒÏ„Î¹Î¬Î¶Î¿Î½Ï„Î±Ï‚ ÏƒÎµ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Î±Ï€ÏŒ Ï„Î¹Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ â€œChargers & Power Adaptersâ€ ÎºÎ±Î¹ â€œCar Chargersâ€.

**Î’Î®Î¼Î± 1**: ÎÎµÎºÎ¹Î½Î¬Ï„Îµ Î¼Îµ Ï„Î·Î½ Ï€ÏÎ¿ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Ï€ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ "meta_Cell_Phones_and_Accessories.json", ÎºÏÎ±Ï„ÏÎ½Ï„Î±Ï‚ Î¼ÏŒÎ½Î¿ Ï„Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Î¼Îµ Î¼Î· ÎºÎµÎ½Î® Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î® ÎºÎ±Î¹ Ï„Î¹Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î­Î½Î± Ï„ÎµÎ»Î¹ÎºÏŒ dataset Î¼Îµ Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î­Ï‚ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½ ÎºÎ±Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚.

**Î’Î®Î¼Î± 2**: Î ÎµÎ¹ÏÎ±Î¼Î±Ï„Î¯Î¶ÎµÏƒÏ„Îµ Î¼Îµ Ï„ÏÎµÎ¹Ï‚ classifiers: Logistic Regression, SVM, ÎºÎ±Î¹ Multi-Layer Perceptron. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ 5-fold cross validation Î³Î¹Î± Ï„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Ï‰Î½ Î¼Î¿Î½Ï„Î­Î»Ï‰Î½ ÎºÎ±Î¹ Ï„Î·Î½ tf-idf Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Ï„Ï‰Î½ Ï€ÎµÏÎ¹Î³ÏÎ±Ï†ÏÎ½ Î³Î¹Î± Ï„Î·Î½ ÎµÎ¾Î±Î³Ï‰Î³Î® Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏÎ½. Î‘Î½Î±Ï†Î­ÏÎµÏ„Îµ Ï„Î¿ Î¼Î­ÏƒÎ¿ confusion matrix ÎºÎ±Î¹ Ï„Î¹Ï‚ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚ accuracy, precision, recall ÎºÎ±Î¹ F1-measure.

**Î’Î®Î¼Î± 3**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î± Î¯Î´Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿ Î’Î®Î¼Î± 1, Î±Î»Î»Î¬ ÎµÎ¾Î¬Î³ÎµÏ„Îµ Ï„Î± features Î¼Îµ Ï„Î¿ Doc2Vec model Ï€Î¿Ï… ÎµÎºÏ€Î±Î¹Î´ÎµÏÎµÏ„Îµ ÎµÏƒÎµÎ¯Ï‚. Î•ÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ k-fold cross validation ÎºÎ±Î¹ Î¼ÎµÏ„ÏÎ¬Ï„Îµ Ï„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚.

**Î’Î®Î¼Î± 4**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î± Glove word embeddings Î³Î¹Î± Î½Î± ÎµÎºÏ€Î±Î¹Î´ÎµÏÏƒÎµÏ„Îµ Î­Î½Î±Î½ classifier, Î±Î½Î±Ï€Î±ÏÎ¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï‰Ï‚ Î¼Î­ÏƒÎ· Ï„Î¹Î¼Î® Ï„Ï‰Î½ embeddings.

**Bonus**: Î•Ï€Î¯ÏƒÎ·Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÎµÎ¹ÏÎ±Î¼Î±Ï„Î¹ÏƒÏ„ÎµÎ¯Ï„Îµ Î¼Îµ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½ Î³Î¹Î± Î½Î± Î²ÎµÎ»Ï„Î¹ÏÏƒÎµÏ„Îµ Ï„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹Î¿Ï€Î¿Î¯Î·ÏƒÎ·.

<br>

### Î•ÏÏÏ„Î·ÏƒÎ· 3

Î— **Î•ÏÏÏ„Î·ÏƒÎ· 3** ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… Î±Î»Î³Î¿ÏÎ¯Î¸Î¼Î¿Ï… Personalized Pagerank Î³Î¹Î± Ï„Î·Î½ Ï€ÏÏŒÎ²Î»ÎµÏˆÎ· Î±Î½ Î­Î½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¸Î± Î±Î³Î¿ÏÎ¬ÏƒÎµÎ¹ Î­Î½Î± Ï€ÏÎ¿ÏŠÏŒÎ½.

**Î”ÎµÎ´Î¿Î¼Î­Î½Î±**: Î£Î±Ï‚ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹ Î´ÏÎ¿ Î±ÏÏ‡ÎµÎ¯Î±: Ï„Î¿ graph_train_data.txt, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¶ÎµÏÎ³Î· (reviewerID, asin) Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î±Î³Î¿ÏÎ±ÏƒÏ„ÎµÎ¯ Î±Ï€ÏŒ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚, ÎºÎ±Î¹ Ï„Î¿ graph_test_data.txt, Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¶ÎµÏÎ³Î· Î³Î¹Î± Ï„Î± Î¿Ï€Î¿Î¯Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿Î²Î»Î­ÏˆÎµÏ„Îµ Ï„Î·Î½ Î±Î³Î¿ÏÎ¬.

**Î’Î®Î¼Î± 1**: Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î­Î½Î± Î´Î¹Î¼ÎµÏÎ­Ï‚ Î³ÏÎ¬Ï†Î·Î¼Î± Î±Ï€ÏŒ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… training, ÏŒÏ€Î¿Ï… Î¿Î¹ ÎºÏŒÎ¼Î²Î¿Î¹ ÎµÎ¯Î½Î±Î¹ Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ (reviewerID) ÎºÎ±Î¹ Ï„Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± (asin) Î¼Îµ Î±ÎºÎ¼Î­Ï‚ Î½Î± Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï„Î¹Ï‚ Î±Î³Î¿ÏÎ­Ï‚.

**Î’Î®Î¼Î± 2**: Î“Î¹Î± ÎºÎ¬Î¸Îµ Î¶ÎµÏ…Î³Î¬ÏÎ¹ (ğ‘Ÿ, ğ‘) ÏƒÏ„Î¿ test set, ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ Ï„Î¿Î½ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿ Personalized Pagerank, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ ğ‘Ÿ Ï‰Ï‚ ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚. Î¤Î±Î¾Î¹Î½Î¿Î¼Î®ÏƒÏ„Îµ Ï„Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î¹Ï‚ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„ÎµÏ‚ Ï€Î¿Ï… Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶ÎµÎ¹ Î¿ Î±Î»Î³ÏŒÏÎ¹Î¸Î¼Î¿Ï‚, ÎµÎ¾Î±Î¹ÏÏÎ½Ï„Î±Ï‚ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î®Î´Î· Î±Î³Î¿ÏÎ¬ÏƒÎµÎ¹ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚.

**Î’Î®Î¼Î± 3**: ÎšÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÏ„Îµ Ï„Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚ ğ‘ ÏƒÏ„Î¿ ranking ÎºÎ±Î¹ Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶ÎµÏ„Îµ Î´ÏÎ¿ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚ Î³Î¹Î± Ï„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Î¿Ï… Î±Î»Î³Î¿ÏÎ¯Î¸Î¼Î¿Ï…: Ï„Î¿ Mean Reciprocal Rank (MRR) ÎºÎ±Î¹ Ï„Î¿ hit-ratio ÏƒÏ„Î¹Ï‚ Ï€ÏÏÏ„ÎµÏ‚ K Î¸Î­ÏƒÎµÎ¹Ï‚ (HR@K) Î³Î¹Î± K = 1,â€¦,20. Î¤Î­Î»Î¿Ï‚, Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î¼Î¹Î± Î³ÏÎ±Ï†Î¹ÎºÎ® Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… HR@K Ï‰Ï‚ Ï€ÏÎ¿Ï‚ Ï„Î¿ K.

<br>
<br>

Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Ï„Î± ÎµÎ¾Î®Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿:
<br>
Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ meta_Cell_Phones_and_Accessories.json Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼ÎµÏ„Î±Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î± Ï€Î¿Ï… Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± "Cell Phones & Accessories" Î±Ï€ÏŒ Ï„Î¿ Amazon. Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î±, Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î±Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏŒÏ€Ï‰Ï‚:
* reviewerID: ÎœÎ¿Î½Î±Î´Î¹ÎºÏŒÏ‚ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Î³Î¹Î± Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î· Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Ï†Î®ÏƒÎµÎ¹ Ï„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ·.
* asin: ÎœÎ¿Î½Î±Î´Î¹ÎºÏŒÏ‚ Î±Î½Î±Î³Î½Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Î³Î¹Î± Ï„Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½.
* description: Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® Ï„Î¿Ï… Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚, Î· Î¿Ï€Î¿Î¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± strings.
* category: ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½ ÏƒÏ„Î¹Ï‚ Î¿Ï€Î¿Î¯ÎµÏ‚ Î±Î½Î®ÎºÎµÎ¹ Ï„Î¿ ÎºÎ¬Î¸Îµ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿.
